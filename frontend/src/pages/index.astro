---
import Layout from '../layouts/Layout.astro';
import Sidebar from '../components/Sidebar.astro';

const { tenantId } = Astro.locals;

// Mock data fetching (in real app, use `fetch` to Python backend)
const insights = [
    {
        title: "High CPA Alert",
        severity: "high",
        description: "Campaign 'Summer_Promo' has a CPA of $50, which is 25% higher than average.",
        action_item: "Pause low-performing ad sets within this campaign immediately."
    },
    {
        title: "CPA Trending Down",
        severity: "low",
        description: "Cost Per Acquisition has decreased by 15% over the last 7 days.",
        action_item: "Consider scaling budget on these efficient campaigns."
    }
];
---

<Layout title="Dashboard | Marketing Lens">
	<div class="flex min-h-screen">
		<Sidebar />

		<main class="ml-64 flex-1 p-8">
			<header class="flex justify-between items-center mb-8">
				<div>
					<h2 class="text-3xl font-bold text-slate-900">Executive Overview</h2>
					<p class="text-slate-500 mt-1">Unified performance view across all channels.</p>
				</div>
				<div class="flex gap-2">
                    <button class="px-4 py-2 bg-white border border-slate-200 rounded text-sm font-medium text-slate-600 hover:bg-slate-50">Last 30 Days</button>
					<button class="px-4 py-2 bg-[var(--color-deep-azure)] text-white rounded text-sm font-medium hover:bg-[var(--color-deep-azure-hover)]">Export Report</button>
				</div>
			</header>

            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                    <h3 class="text-sm font-medium text-slate-500">Total Spend</h3>
                    <p class="text-3xl font-bold text-slate-900 mt-2">$24,500</p>
                    <span class="text-xs font-medium text-green-600 bg-green-50 px-2 py-1 rounded-full mt-2 inline-block">+12.5%</span>
                </div>
                <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                    <h3 class="text-sm font-medium text-slate-500">Total Conversions</h3>
                    <p class="text-3xl font-bold text-slate-900 mt-2">1,240</p>
                    <span class="text-xs font-medium text-green-600 bg-green-50 px-2 py-1 rounded-full mt-2 inline-block">+5.2%</span>
                </div>
                <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                    <h3 class="text-sm font-medium text-slate-500">Organic Sessions (GA4)</h3>
                    <p class="text-3xl font-bold text-slate-900 mt-2">45,200</p>
                    <span class="text-xs font-medium text-red-600 bg-red-50 px-2 py-1 rounded-full mt-2 inline-block">-2.1%</span>
                </div>
                <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                    <h3 class="text-sm font-medium text-slate-500">LinkedIn Followers</h3>
                    <p class="text-3xl font-bold text-slate-900 mt-2">8,540</p>
                    <span class="text-xs font-medium text-green-600 bg-green-50 px-2 py-1 rounded-full mt-2 inline-block">+150</span>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Chart Section -->
                <div class="lg:col-span-2 bg-white p-6 rounded-xl border border-slate-100 shadow-sm min-h-[400px]">
                    <h3 class="font-bold text-slate-800 mb-4">Performance Trend</h3>
                    <div class="flex items-center justify-center h-full text-slate-400 bg-slate-50 rounded border border-dashed border-slate-200">
                        Chart Component (Recharts) Placeholder
                    </div>
                </div>

                <!-- Insights Feed -->
                 <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                    <h3 class="font-bold text-slate-800 mb-4">AI Insights</h3>
                    <div class="space-y-4">
                        {insights.map((insight) => (
                            <div class={`p-3 border rounded-lg ${insight.severity === 'high' ? 'bg-red-50 border-red-100' : 'bg-blue-50 border-blue-100'}`}>
                                <div class="flex items-start gap-3">
                                    <div class={`w-2 h-2 rounded-full mt-2 ${insight.severity === 'high' ? 'bg-red-500' : 'bg-blue-500'}`}></div>
                                    <div>
                                        <p class="text-sm font-bold text-slate-900">{insight.title}</p>
                                        <p class="text-xs text-slate-600 mt-1">{insight.description}</p>
                                        <p class="text-xs font-medium text-slate-800 mt-2">Action: {insight.action_item}</p>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            </div>

		</main>
	</div>
</Layout>
